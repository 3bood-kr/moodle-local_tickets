{"version":3,"file":"modalforms.min.js","sources":["../src/modalforms.js"],"sourcesContent":["import ModalForm from 'core_form/modalform';\r\nimport {add as addToast} from 'core/toast';\r\n\r\nconst addNotification = (msg, type) => {\r\n    addToast(msg, {type: type});\r\n};\r\n\r\nexport const modalForm = (linkSelector, formClass, title, args = {...args, hidebuttons: args.hidebuttons ?? 1}) => {\r\n    document.querySelector(linkSelector).addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n        const form = new ModalForm({\r\n            formClass,\r\n            args: args,\r\n            modalConfig: {title: title},\r\n            returnFocus: e.currentTarget\r\n        });\r\n        form.addEventListener(form.events.FORM_SUBMITTED, (e) => {\r\n            // Comes from process_dynamic_submission() in submitticketform.php\r\n            const response = e.detail;\r\n            const type = response.status == 200 ? 'success' : 'danger';\r\n            addNotification(response.message, type);\r\n        });\r\n        form.addEventListener(form.events.ERROR, (e) => addNotification('Oopsie - ' + e.detail.message));\r\n        form.show();\r\n    });\r\n\r\n};\r\n\r\nexport const changeStatusModalForms = (linkSelector, formClass, args = {...args, hidebuttons: args.hidebuttons ?? 1}) => {\r\n    const elements = document.querySelectorAll(linkSelector);\r\n    // Attach a click event listener to each element.\r\n    elements.forEach(element => {\r\n        element.addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            const ticketId = element.dataset.ticketId;\r\n            const form = new ModalForm({\r\n                formClass,\r\n                args: {...args, id: ticketId},\r\n                modalConfig: {title: 'Edit Status'},\r\n                returnFocus: e.currentTarget\r\n            });\r\n            form.addEventListener(form.events.FORM_SUBMITTED, (e) => {\r\n                const response = e.detail;\r\n                let type;\r\n                if(response.status == 200){\r\n                    type = 'success';\r\n                    location.reload();\r\n                } else {\r\n                    type = 'danger';\r\n                }\r\n                addNotification(response.message, type);\r\n\r\n            });\r\n            form.addEventListener(form.events.ERROR, (e) => {\r\n                addNotification('Oopsie - ' + e.detail.message);\r\n            });\r\n            form.show();\r\n        });\r\n    });\r\n};"],"names":["obj","_modalform","__esModule","default","addNotification","msg","type","addToast","_exports","modalForm","linkSelector","formClass","title","args","arguments","length","undefined","hidebuttons","document","querySelector","addEventListener","e","preventDefault","form","ModalForm","modalConfig","returnFocus","currentTarget","events","FORM_SUBMITTED","response","detail","status","message","ERROR","show","changeStatusModalForms","querySelectorAll","forEach","element","ticketId","dataset","id","location","reload"],"mappings":"uHAA4C,IAAAA,sHAA5CC,YAA4CD,IAA5CC,aAA4CD,IAAAE,WAAAF,IAAAG,CAAAA,QAAAH,KAG5C,MAAMI,gBAAkBA,CAACC,IAAKC,SAC1B,EAAAC,OAAAA,KAASF,IAAK,CAACC,KAAMA,MAAM,EAsB7BE,SAAAC,UAnBuB,SAACC,aAAcC,UAAWC,OAAgE,IAAzDC,KAAIC,UAAAC,OAAAD,QAAAE,IAAAF,UAAAE,GAAAF,UAAG,GAAA,IAAID,KAAMI,YAAaJ,KAAKI,aAAe,GACxGC,SAASC,cAAcT,cAAcU,iBAAiB,SAAUC,IAC5DA,EAAEC,iBACF,MAAMC,KAAO,IAAIC,WAAAA,QAAU,CACvBb,oBACAE,KAAMA,KACNY,YAAa,CAACb,MAAOA,OACrBc,YAAaL,EAAEM,gBAEnBJ,KAAKH,iBAAiBG,KAAKK,OAAOC,gBAAiBR,IAE/C,MAAMS,SAAWT,EAAEU,OACbzB,KAA0B,KAAnBwB,SAASE,OAAgB,UAAY,SAClD5B,gBAAgB0B,SAASG,QAAS3B,KAAK,IAE3CiB,KAAKH,iBAAiBG,KAAKK,OAAOM,OAAQb,GAAMjB,gBAAgB,YAAciB,EAAEU,OAAOE,WACvFV,KAAKY,MAAM,KAoCjB3B,SAAA4B,uBA/BoC,SAAC1B,aAAcC,WAAoE,IAAzDE,KAAIC,UAAAC,OAAAD,QAAAE,IAAAF,UAAAE,GAAAF,UAAG,GAAA,IAAID,KAAMI,YAAaJ,KAAKI,aAAe,GAC7FC,SAASmB,iBAAiB3B,cAElC4B,SAAQC,UACbA,QAAQnB,iBAAiB,SAAUC,IAC/BA,EAAEC,iBACF,MAAMkB,SAAWD,QAAQE,QAAQD,SAC3BjB,KAAO,IAAIC,WAAAA,QAAU,CACvBb,oBACAE,KAAM,IAAIA,KAAM6B,GAAIF,UACpBf,YAAa,CAACb,MAAO,eACrBc,YAAaL,EAAEM,gBAEnBJ,KAAKH,iBAAiBG,KAAKK,OAAOC,gBAAiBR,IAC/C,MAAMS,SAAWT,EAAEU,OACnB,IAAIzB,KACkB,KAAnBwB,SAASE,QACR1B,KAAO,UACPqC,SAASC,UAETtC,KAAO,SAEXF,gBAAgB0B,SAASG,QAAS3B,KAAK,IAG3CiB,KAAKH,iBAAiBG,KAAKK,OAAOM,OAAQb,IACtCjB,gBAAgB,YAAciB,EAAEU,OAAOE,QAAQ,IAEnDV,KAAKY,MAAM,GACb,IAER"}