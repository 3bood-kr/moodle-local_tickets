{"version":3,"file":"modalforms.min.js","sources":["../src/modalforms.js"],"sourcesContent":["import ModalForm from 'core_form/modalform';\nimport {add as addToast} from 'core/toast';\nimport {get_string as getString} from 'core/str';\n\n\nconst addNotification = (msg, type) => {\n    addToast(msg, {type: type});\n};\n\nexport const modalForm = (linkSelector, formClass, title, args = {...args, hidebuttons: args.hidebuttons ?? 1}) => {\n    document.querySelector(linkSelector).addEventListener('click', (e) => {\n        e.preventDefault();\n        const form = new ModalForm({\n            formClass,\n            args: args,\n            modalConfig: {title: title},\n            returnFocus: e.currentTarget\n        });\n        form.addEventListener(form.events.FORM_SUBMITTED, (e) => {\n            // Comes from process_dynamic_submission() in submitticketform.php\n            const response = e.detail;\n            const type = response.status == 200 ? 'success' : 'danger';\n            addNotification(response.message, type);\n        });\n        form.addEventListener(form.events.ERROR, (e) => addNotification('Oopsie - ' + e.detail.message));\n        form.show();\n    });\n\n};\n\nexport const changeStatusModalForms = (linkSelector, formClass, args = {...args, hidebuttons: args.hidebuttons ?? 1}) => {\n    const elements = document.querySelectorAll(linkSelector);\n    // Attach a click event listener to each element.\n    elements.forEach(element => {\n        element.addEventListener('click', (e) => {\n            e.preventDefault();\n            const ticketId = element.dataset.ticketId;\n            const form = new ModalForm({\n                formClass,\n                args: {...args, id: ticketId},\n                modalConfig: {title: getString('edit_status', 'local_tickets')},\n                returnFocus: e.currentTarget\n            });\n            form.addEventListener(form.events.FORM_SUBMITTED, (e) => {\n                const response = e.detail;\n                let type;\n                if(response.status == 200){\n                    type = 'success';\n                    location.reload();\n                } else {\n                    type = 'danger';\n                }\n                addNotification(response.message, type);\n\n            });\n            form.addEventListener(form.events.ERROR, (e) => {\n                addNotification('Oopsie - ' + e.detail.message);\n            });\n            form.show();\n        });\n    });\n};"],"names":["e","_modalform","__esModule","default","addNotification","msg","type","addToast","_exports","modalForm","linkSelector","formClass","title","args","arguments","length","undefined","hidebuttons","document","querySelector","addEventListener","preventDefault","form","ModalForm","modalConfig","returnFocus","currentTarget","events","FORM_SUBMITTED","response","detail","status","message","ERROR","show","changeStatusModalForms","querySelectorAll","forEach","element","ticketId","dataset","id","getString","location","reload"],"mappings":"uIAA4C,IAAAA,oHAA5CC,YAA4CD,EAA5CC,aAA4CD,EAAAE,WAAAF,EAAAG,CAAAA,QAAAH,GAK5C,MAAMI,gBAAkBA,CAACC,IAAKC,SAC1B,EAAAC,OAAAA,KAASF,IAAK,CAACC,KAAMA,MAAM,EAsB7BE,SAAAC,UAnBuB,SAACC,aAAcC,UAAWC,OAAgE,IAAzDC,KAAIC,UAAAC,OAAAD,QAAAE,IAAAF,UAAAE,GAAAF,UAAG,GAAA,IAAID,KAAMI,YAAaJ,KAAKI,aAAe,GACxGC,SAASC,cAAcT,cAAcU,iBAAiB,SAAUpB,IAC5DA,EAAEqB,iBACF,MAAMC,KAAO,IAAIC,WAAAA,QAAU,CACvBZ,oBACAE,KAAMA,KACNW,YAAa,CAACZ,MAAOA,OACrBa,YAAazB,EAAE0B,gBAEnBJ,KAAKF,iBAAiBE,KAAKK,OAAOC,gBAAiB5B,IAE/C,MAAM6B,SAAW7B,EAAE8B,OACbxB,KAA0B,KAAnBuB,SAASE,OAAgB,UAAY,SAClD3B,gBAAgByB,SAASG,QAAS1B,KAAK,IAE3CgB,KAAKF,iBAAiBE,KAAKK,OAAOM,OAAQjC,GAAMI,gBAAgB,YAAcJ,EAAE8B,OAAOE,WACvFV,KAAKY,MAAM,KAoCjB1B,SAAA2B,uBA/BoC,SAACzB,aAAcC,WAAoE,IAAzDE,KAAIC,UAAAC,OAAAD,QAAAE,IAAAF,UAAAE,GAAAF,UAAG,GAAA,IAAID,KAAMI,YAAaJ,KAAKI,aAAe,GAC7FC,SAASkB,iBAAiB1B,cAElC2B,SAAQC,UACbA,QAAQlB,iBAAiB,SAAUpB,IAC/BA,EAAEqB,iBACF,MAAMkB,SAAWD,QAAQE,QAAQD,SAC3BjB,KAAO,IAAIC,WAAAA,QAAU,CACvBZ,oBACAE,KAAM,IAAIA,KAAM4B,GAAIF,UACpBf,YAAa,CAACZ,OAAO,EAAA8B,KAAAA,YAAU,cAAe,kBAC9CjB,YAAazB,EAAE0B,gBAEnBJ,KAAKF,iBAAiBE,KAAKK,OAAOC,gBAAiB5B,IAC/C,MAAM6B,SAAW7B,EAAE8B,OACnB,IAAIxB,KACkB,KAAnBuB,SAASE,QACRzB,KAAO,UACPqC,SAASC,UAETtC,KAAO,SAEXF,gBAAgByB,SAASG,QAAS1B,KAAK,IAG3CgB,KAAKF,iBAAiBE,KAAKK,OAAOM,OAAQjC,IACtCI,gBAAgB,YAAcJ,EAAE8B,OAAOE,QAAQ,IAEnDV,KAAKY,MAAM,GACb,IAER"}