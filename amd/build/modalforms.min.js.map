{"version":3,"file":"modalforms.min.js","sources":["../src/modalforms.js"],"sourcesContent":["import ModalForm from 'core_form/modalform';\r\nimport {add as addToast} from 'core/toast';\r\nimport {call as ajaxCall} from 'core/ajax';\r\n\r\nconst addNotification = (msg, type) => {\r\n    addToast(msg, {type: type});\r\n    // eslint-disable-next-line no-console\r\n    console.log(msg);\r\n};\r\n\r\nexport const modalForm = (linkSelector, formClass, methodName, title, args = {hidebuttons: 1, ...args}) => {\r\n    document.querySelector(linkSelector).addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n        const form = new ModalForm({\r\n            formClass,\r\n            args: args,\r\n            modalConfig: {title: title},\r\n            returnFocus: e.currentTarget\r\n        });\r\n        \r\n        form.addEventListener(form.events.FORM_SUBMITTED, (e) => {\r\n            const formData = JSON.stringify(e.detail);\r\n            ajaxCall([{\r\n                methodname: methodName, \r\n                args: {data: formData},\r\n                done: function(response) {\r\n                    const type = response?.status === 200 ? 'success' : 'danger';\r\n                    addNotification(response.message, type);\r\n                },\r\n                fail: function(ex) {\r\n                    console.log(ex);\r\n                    addNotification(`Failed to submit the form: ${ex.message}`, 'danger');\r\n                }\r\n            }]);\r\n\r\n        });\r\n\r\n        // Demo of different events.\r\n        form.addEventListener(form.events.ERROR, (e) => addNotification('Oopsie - ' + e.detail.message));\r\n        form.show();\r\n    });\r\n\r\n};\r\n\r\nexport const changeStatusModalForms = (linkSelector, formClass, methodName, title, args = {hidebuttons: 1, ...args}) => {\r\n    const elements = document.querySelectorAll(linkSelector);\r\n    // Attach a click event listener to each element.\r\n    elements.forEach(element => {\r\n        element.addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            const ticketId = element.dataset.ticketId;\r\n            console.log(ticketId);\r\n            const form = new ModalForm({\r\n                formClass,\r\n                args: args,\r\n                modalConfig: {title: 'Edit Status'},\r\n                returnFocus: e.currentTarget\r\n            });\r\n\r\n            form.addEventListener(form.events.FORM_SUBMITTED, (e) => {\r\n                const formData = JSON.stringify(e.detail);\r\n                ajaxCall([{\r\n                    methodname: methodName,\r\n                    args: {data: formData},\r\n                    done: function(response) {\r\n                        const type = response?.status === 200 ? 'success' : 'danger';\r\n                        addNotification(response.message, type);\r\n                    },\r\n                    fail: function(ex) {\r\n                        console.log(ex);\r\n                        addNotification(`Failed to submit the form: ${ex.message}`, 'danger');\r\n                    }\r\n                }]);\r\n            });\r\n\r\n            // Handle other form events\r\n            form.addEventListener(form.events.ERROR, (e) => {\r\n                addNotification('Oopsie - ' + e.detail.message);\r\n            });\r\n\r\n            // Show the form\r\n            form.show();\r\n        });\r\n    });\r\n};"],"names":["obj","_modalform","__esModule","default","addNotification","msg","type","addToast","console","log","_exports","modalForm","linkSelector","formClass","methodName","title","args","arguments","length","undefined","hidebuttons","document","querySelector","addEventListener","e","preventDefault","form","ModalForm","modalConfig","returnFocus","currentTarget","events","FORM_SUBMITTED","formData","JSON","stringify","detail","ajaxCall","methodname","data","done","response","status","message","fail","ex","ERROR","show","changeStatusModalForms","querySelectorAll","forEach","element","ticketId","dataset"],"mappings":"yIAA4C,IAAAA,sHAA5CC,YAA4CD,IAA5CC,aAA4CD,IAAAE,WAAAF,IAAAG,CAAAA,QAAAH,KAI5C,MAAMI,gBAAkBA,CAACC,IAAKC,SAC1B,EAAAC,OAAAA,KAASF,IAAK,CAACC,KAAMA,OAErBE,QAAQC,IAAIJ,IAAI,EAmClBK,SAAAC,UAhCuB,SAACC,aAAcC,UAAWC,WAAYC,OAA4C,IAArCC,KAAIC,UAAAC,OAAAD,QAAAE,IAAAF,UAAAE,GAAAF,UAAG,GAAA,CAACG,YAAa,KAAMJ,MAC7FK,SAASC,cAAcV,cAAcW,iBAAiB,SAAUC,IAC5DA,EAAEC,iBACF,MAAMC,KAAO,IAAIC,WAAAA,QAAU,CACvBd,oBACAG,KAAMA,KACNY,YAAa,CAACb,MAAOA,OACrBc,YAAaL,EAAEM,gBAGnBJ,KAAKH,iBAAiBG,KAAKK,OAAOC,gBAAiBR,IAC/C,MAAMS,SAAWC,KAAKC,UAAUX,EAAEY,SAClC,EAAAC,MAAAA,MAAS,CAAC,CACNC,WAAYxB,WACZE,KAAM,CAACuB,KAAMN,UACbO,KAAM,SAASC,UACX,MAAMnC,KAA4B,MAArBmC,UAAUC,OAAiB,UAAY,SACpDtC,gBAAgBqC,SAASE,QAASrC,KACrC,EACDsC,KAAM,SAASC,IACXrC,QAAQC,IAAIoC,IACZzC,gBAAiB,8BAA6ByC,GAAGF,UAAW,SAChE,IACD,IAKPjB,KAAKH,iBAAiBG,KAAKK,OAAOe,OAAQtB,GAAMpB,gBAAgB,YAAcoB,EAAEY,OAAOO,WACvFjB,KAAKqB,MAAM,KA6CjBrC,SAAAsC,uBAxCoC,SAACpC,aAAcC,UAAWC,WAAYC,OAA4C,IAArCC,KAAIC,UAAAC,OAAAD,QAAAE,IAAAF,UAAAE,GAAAF,UAAG,GAAA,CAACG,YAAa,KAAMJ,MACzFK,SAAS4B,iBAAiBrC,cAElCsC,SAAQC,UACbA,QAAQ5B,iBAAiB,SAAUC,IAC/BA,EAAEC,iBACF,MAAM2B,SAAWD,QAAQE,QAAQD,SACjC5C,QAAQC,IAAI2C,UACZ,MAAM1B,KAAO,IAAIC,WAAAA,QAAU,CACvBd,oBACAG,KAAMA,KACNY,YAAa,CAACb,MAAO,eACrBc,YAAaL,EAAEM,gBAGnBJ,KAAKH,iBAAiBG,KAAKK,OAAOC,gBAAiBR,IAC/C,MAAMS,SAAWC,KAAKC,UAAUX,EAAEY,SAClC,EAAAC,MAAAA,MAAS,CAAC,CACNC,WAAYxB,WACZE,KAAM,CAACuB,KAAMN,UACbO,KAAM,SAASC,UACX,MAAMnC,KAA4B,MAArBmC,UAAUC,OAAiB,UAAY,SACpDtC,gBAAgBqC,SAASE,QAASrC,KACrC,EACDsC,KAAM,SAASC,IACXrC,QAAQC,IAAIoC,IACZzC,gBAAiB,8BAA6ByC,GAAGF,UAAW,SAChE,IACD,IAIPjB,KAAKH,iBAAiBG,KAAKK,OAAOe,OAAQtB,IACtCpB,gBAAgB,YAAcoB,EAAEY,OAAOO,QAAQ,IAInDjB,KAAKqB,MAAM,GACb,IAER"}