{"version":3,"file":"modalforms.min.js","sources":["../src/modalforms.js"],"sourcesContent":["import ModalForm from 'core_form/modalform';\r\nimport {add as addToast} from 'core/toast';\r\nimport {get_string as getString} from 'core/str';\r\n\r\n\r\nconst addNotification = (msg, type) => {\r\n    addToast(msg, {type: type});\r\n};\r\n\r\nexport const modalForm = (linkSelector, formClass, title, args = {...args, hidebuttons: args.hidebuttons ?? 1}) => {\r\n    document.querySelector(linkSelector).addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n        const form = new ModalForm({\r\n            formClass,\r\n            args: args,\r\n            modalConfig: {title: title},\r\n            returnFocus: e.currentTarget\r\n        });\r\n        form.addEventListener(form.events.FORM_SUBMITTED, (e) => {\r\n            // Comes from process_dynamic_submission() in submitticketform.php\r\n            const response = e.detail;\r\n            const type = response.status == 200 ? 'success' : 'danger';\r\n            addNotification(response.message, type);\r\n        });\r\n        form.addEventListener(form.events.ERROR, (e) => addNotification('Oopsie - ' + e.detail.message));\r\n        form.show();\r\n    });\r\n\r\n};\r\n\r\nexport const changeStatusModalForms = (linkSelector, formClass, args = {...args, hidebuttons: args.hidebuttons ?? 1}) => {\r\n    const elements = document.querySelectorAll(linkSelector);\r\n    // Attach a click event listener to each element.\r\n    elements.forEach(element => {\r\n        element.addEventListener('click', (e) => {\r\n            e.preventDefault();\r\n            const ticketId = element.dataset.ticketId;\r\n            const form = new ModalForm({\r\n                formClass,\r\n                args: {...args, id: ticketId},\r\n                modalConfig: {title: getString('edit_status', 'local_tickets')},\r\n                returnFocus: e.currentTarget\r\n            });\r\n            form.addEventListener(form.events.FORM_SUBMITTED, (e) => {\r\n                const response = e.detail;\r\n                let type;\r\n                if(response.status == 200){\r\n                    type = 'success';\r\n                    location.reload();\r\n                } else {\r\n                    type = 'danger';\r\n                }\r\n                addNotification(response.message, type);\r\n\r\n            });\r\n            form.addEventListener(form.events.ERROR, (e) => {\r\n                addNotification('Oopsie - ' + e.detail.message);\r\n            });\r\n            form.show();\r\n        });\r\n    });\r\n};"],"names":["e","_modalform","__esModule","default","addNotification","msg","type","addToast","_exports","modalForm","linkSelector","formClass","title","args","arguments","length","undefined","hidebuttons","document","querySelector","addEventListener","preventDefault","form","ModalForm","modalConfig","returnFocus","currentTarget","events","FORM_SUBMITTED","response","detail","status","message","ERROR","show","changeStatusModalForms","querySelectorAll","forEach","element","ticketId","dataset","id","getString","location","reload"],"mappings":"uIAA4C,IAAAA,oHAA5CC,YAA4CD,EAA5CC,aAA4CD,EAAAE,WAAAF,EAAAG,CAAAA,QAAAH,GAK5C,MAAMI,gBAAkBA,CAACC,IAAKC,SAC1B,EAAAC,OAAAA,KAASF,IAAK,CAACC,KAAMA,MAAM,EAsB7BE,SAAAC,UAnBuB,SAACC,aAAcC,UAAWC,OAAgE,IAAzDC,KAAIC,UAAAC,OAAAD,QAAAE,IAAAF,UAAAE,GAAAF,UAAG,GAAA,IAAID,KAAMI,YAAaJ,KAAKI,aAAe,GACxGC,SAASC,cAAcT,cAAcU,iBAAiB,SAAUpB,IAC5DA,EAAEqB,iBACF,MAAMC,KAAO,IAAIC,WAAAA,QAAU,CACvBZ,oBACAE,KAAMA,KACNW,YAAa,CAACZ,MAAOA,OACrBa,YAAazB,EAAE0B,gBAEnBJ,KAAKF,iBAAiBE,KAAKK,OAAOC,gBAAiB5B,IAE/C,MAAM6B,SAAW7B,EAAE8B,OACbxB,KAA0B,KAAnBuB,SAASE,OAAgB,UAAY,SAClD3B,gBAAgByB,SAASG,QAAS1B,KAAK,IAE3CgB,KAAKF,iBAAiBE,KAAKK,OAAOM,OAAQjC,GAAMI,gBAAgB,YAAcJ,EAAE8B,OAAOE,WACvFV,KAAKY,MAAM,KAoCjB1B,SAAA2B,uBA/BoC,SAACzB,aAAcC,WAAoE,IAAzDE,KAAIC,UAAAC,OAAAD,QAAAE,IAAAF,UAAAE,GAAAF,UAAG,GAAA,IAAID,KAAMI,YAAaJ,KAAKI,aAAe,GAC7FC,SAASkB,iBAAiB1B,cAElC2B,SAAQC,UACbA,QAAQlB,iBAAiB,SAAUpB,IAC/BA,EAAEqB,iBACF,MAAMkB,SAAWD,QAAQE,QAAQD,SAC3BjB,KAAO,IAAIC,WAAAA,QAAU,CACvBZ,oBACAE,KAAM,IAAIA,KAAM4B,GAAIF,UACpBf,YAAa,CAACZ,OAAO,EAAA8B,KAAAA,YAAU,cAAe,kBAC9CjB,YAAazB,EAAE0B,gBAEnBJ,KAAKF,iBAAiBE,KAAKK,OAAOC,gBAAiB5B,IAC/C,MAAM6B,SAAW7B,EAAE8B,OACnB,IAAIxB,KACkB,KAAnBuB,SAASE,QACRzB,KAAO,UACPqC,SAASC,UAETtC,KAAO,SAEXF,gBAAgByB,SAASG,QAAS1B,KAAK,IAG3CgB,KAAKF,iBAAiBE,KAAKK,OAAOM,OAAQjC,IACtCI,gBAAgB,YAAcJ,EAAE8B,OAAOE,QAAQ,IAEnDV,KAAKY,MAAM,GACb,IAER"}