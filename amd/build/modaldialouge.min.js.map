{"version":3,"file":"modaldialouge.min.js","sources":["../src/modaldialouge.js"],"sourcesContent":["import ModalFactory from 'core/modal_factory';\r\nimport ModalEvents from 'core/modal_events';\r\nimport {call as ajaxCall} from 'core/ajax';\r\nimport Templates from 'core/templates';\r\nimport fragment from 'core/fragment';\r\nimport {add as addToast} from 'core/toast';\r\nimport {get_string as getString} from 'core/str';\r\n\r\nconst addNotification = (msg, type) => {\r\n    addToast(msg, {type: type});\r\n};\r\n\r\n\r\nexport const  init = (linkSelector, title) => {\r\n    document.querySelector(linkSelector).addEventListener('click', (e) => {\r\n        e.preventDefault();\r\n        createAndShowModal(title); \r\n    });\r\n};\r\n\r\nasync function createAndShowModal(title) {\r\n\r\n    let modal;\r\n    // Function to create and show modal\r\n    async function showModal() {\r\n        // Create the modal\r\n        modal = await ModalFactory.create({\r\n            large: true,\r\n            title: title,\r\n            body: await fragment.loadFragment('local_tickets', 'rerender_modal_dialouge', M.cfg.contextid, {page: 0}),\r\n        });\r\n\r\n        console.log(await fragment.loadFragment('local_tickets', 'rerender_modal_dialouge', M.cfg.contextid, {page: 0}));\r\n        // Initialize delete popup\r\n        require(['local_tickets/deletepopup'], function(deletepopup) {\r\n            deletepopup.init();\r\n        });\r\n\r\n        // Destroy modal on hide\r\n        modal.getRoot().on(ModalEvents.hidden, function() {\r\n            modal.destroy();\r\n        });\r\n\r\n        // Show the modal\r\n        modal.show();\r\n    }\r\n\r\n    // Function to handle pagination link clicks\r\n    async function handlePaginationLinkClick(event, pageNum) {\r\n        event.preventDefault();\r\n        if(modal){\r\n            await fragment.loadFragment('local_tickets', 'rerender_modal_dialouge', M.cfg.contextid, {page: pageNum-1}).then((html, js) => {\r\n                modal.setBody(html);\r\n                // Initialize delete popup\r\n                require(['local_tickets/deletepopup'], function(deletepopup) {\r\n                    deletepopup.init();\r\n                });\r\n            });\r\n            //reattach pagination listeners\r\n            attachPaginationListeners();\r\n        }\r\n    }\r\n\r\n    // Function to attach event listeners to pagination links\r\n    async function attachPaginationListeners() {\r\n        const paginationLinks = document.querySelectorAll('.modal-body .page-link');\r\n        paginationLinks.forEach(function(link) {\r\n            link.removeEventListener('click', handlePaginationLinkClick); // Remove previous listener if any\r\n            link.addEventListener('click', (event) => handlePaginationLinkClick(event, link.parentElement.getAttribute('data-page-number')));\r\n        });\r\n    }\r\n\r\n    // Create and show the modal\r\n    await showModal();\r\n    attachPaginationListeners();\r\n}\r\n\r\n\r\n"],"names":["_interopRequireDefault","e","__esModule","default","_modal_factory","_modal_events","_templates","_fragment","_exports","init","linkSelector","title","document","querySelector","addEventListener","preventDefault","async","modal","showModal","ModalFactory","create","large","body","fragment","loadFragment","M","cfg","contextid","page","console","log","require","deletepopup","getRoot","on","ModalEvents","hidden","destroy","show","handlePaginationLinkClick","event","pageNum","then","html","js","setBody","attachPaginationListeners","querySelectorAll","forEach","link","removeEventListener","parentElement","getAttribute","createAndShowModal"],"mappings":"uPAIqC,SAAAA,uBAAAC,GAAAA,OAAAA,GAAAA,EAAAC,WAAAD,EAAAE,CAAAA,QAAAF,EAAA,8EAJrCG,eAAAJ,uBAAAI,gBACAC,cAAAL,uBAAAK,eAEAC,WAAAN,uBAAAM,YACAC,UAAAP,uBAAAO,WAcEC,SAAAC,KALmBA,CAACC,aAAcC,SAChCC,SAASC,cAAcH,cAAcI,iBAAiB,SAAUb,IAC5DA,EAAEc,iBAKVC,eAAkCL,OAE9B,IAAIM,MAEJD,eAAeE,YAEXD,YAAcE,eAAYhB,QAACiB,OAAO,CAC9BC,OAAO,EACPV,MAAOA,MACPW,WAAYC,UAAQpB,QAACqB,aAAa,gBAAiB,0BAA2BC,EAAEC,IAAIC,UAAW,CAACC,KAAM,MAG1GC,QAAQC,UAAUP,UAAAA,QAASC,aAAa,gBAAiB,0BAA2BC,EAAEC,IAAIC,UAAW,CAACC,KAAM,KAE5GG,QAAQ,CAAC,8BAA8B,SAASC,aAC5CA,YAAYvB,MAChB,IAGAQ,MAAMgB,UAAUC,GAAGC,cAAWhC,QAACiC,QAAQ,WACnCnB,MAAMoB,SACV,IAGApB,MAAMqB,MACV,CAGAtB,eAAeuB,0BAA0BC,MAAOC,SAC5CD,MAAMzB,iBACHE,cACOM,UAAQpB,QAACqB,aAAa,gBAAiB,0BAA2BC,EAAEC,IAAIC,UAAW,CAACC,KAAMa,QAAQ,IAAIC,MAAK,CAACC,KAAMC,MACpH3B,MAAM4B,QAAQF,MAEdZ,QAAQ,CAAC,8BAA8B,SAASC,aAC5CA,YAAYvB,MAChB,GAAE,IAGNqC,4BAER,CAGA9B,eAAe8B,4BACalC,SAASmC,iBAAiB,0BAClCC,SAAQ,SAASC,MAC7BA,KAAKC,oBAAoB,QAASX,2BAClCU,KAAKnC,iBAAiB,SAAU0B,OAAUD,0BAA0BC,MAAOS,KAAKE,cAAcC,aAAa,sBAC/G,GACJ,OAGMlC,YACN4B,2BACJ,CA3DQO,CAAmB1C,MAAM,GAC3B,CA0DL"}