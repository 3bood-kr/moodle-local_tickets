define("local_tickets/modaldialouge",["exports","core/modal_factory","core/ajax","core/templates","core/fragment","core/toast","core/str"],(function(_exports,_modal_factory,_ajax,_templates,_fragment,_toast,_str){function _interopRequireDefault(e){return e&&e.__esModule?e:{default:e}}Object.defineProperty(_exports,"__esModule",{value:!0}),_exports.init=void 0,_modal_factory=_interopRequireDefault(_modal_factory),_templates=_interopRequireDefault(_templates),_fragment=_interopRequireDefault(_fragment);const addNotification=(msg,type)=>{(0,_toast.add)(msg,{type:type})};_exports.init=function(linkSelector,title){let own=!(arguments.length>2&&void 0!==arguments[2])||arguments[2];document.querySelector(linkSelector).addEventListener("click",(e=>{e.preventDefault();var filterForm="";_fragment.default.loadFragment("local_tickets","new_filter_form",M.cfg.contextid,{}).done((function(html,js){filterForm=html})).fail((function(ex){console.error("Failed to load fragment:",ex)})),(0,_ajax.call)([{methodname:"local_tickets_get_tickets",args:{own:own},done:async function(response){if(200==response.status){const tickets=JSON.parse(response.data),modal=await _modal_factory.default.create({large:!0,title:title,body:_templates.default.render("local_tickets/modaldialouge",{tickets:tickets,filterform:filterForm})});require(["local_tickets/deletepopup"],(function(deletepopup){deletepopup.init()})),modal.show()}else addNotification(response.message,"danger")},fail:function(ex){addNotification(`Failed to fetch ticket: ${ex}`,"danger")}}])}))}}));

//# sourceMappingURL=modaldialouge.min.js.map